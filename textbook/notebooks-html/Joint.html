<div id="ipython-notebook">
            <a class="interact-button" href="http://prob140.berkeley.edu/user-redirect/interact?repo=prob140&path=textbook/prob140/Joint.ipynb">Interact</a>
            
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Dependence">Dependence<a class="anchor-link" href="#Dependence">¶</a></h3></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">heads_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">domain</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.9</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">heads_table</span><span class="p">[</span><span class="s1">'Probability'</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="o">.</span><span class="mi">75</span><span class="o">*.</span><span class="mi">04</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="o">*.</span><span class="mi">32</span><span class="p">,</span><span class="o">.</span><span class="mi">75</span><span class="o">*.</span><span class="mi">64</span><span class="p">,</span><span class="o">.</span><span class="mi">25</span><span class="o">*.</span><span class="mi">81</span><span class="p">,</span><span class="o">.</span><span class="mi">25</span><span class="o">*.</span><span class="mi">18</span><span class="p">,</span><span class="o">.</span><span class="mi">25</span><span class="o">*.</span><span class="mi">01</span><span class="p">)</span>
<span class="n">joint_dist_new</span> <span class="o">=</span> <span class="n">heads_table</span><span class="o">.</span><span class="n">toJoint</span><span class="p">()</span>
<span class="n">joint_dist_new</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X=0.2</th>
      <th>X=0.9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y=2</th>
      <td>0.03</td>
      <td>0.2025</td>
    </tr>
    <tr>
      <th>Y=1</th>
      <td>0.24</td>
      <td>0.0450</td>
    </tr>
    <tr>
      <th>Y=0</th>
      <td>0.48</td>
      <td>0.0025</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_dist_new</span><span class="o">.</span><span class="n">marginal_of_X</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X=0.2</th>
      <th>X=0.9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y=2</th>
      <td>0.03</td>
      <td>0.2025</td>
    </tr>
    <tr>
      <th>Y=1</th>
      <td>0.24</td>
      <td>0.0450</td>
    </tr>
    <tr>
      <th>Y=0</th>
      <td>0.48</td>
      <td>0.0025</td>
    </tr>
    <tr>
      <th>Sum: Marginal of X</th>
      <td>0.75</td>
      <td>0.2500</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_dist_new</span><span class="o">.</span><span class="n">marginal_of_Y</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X=0.2</th>
      <th>X=0.9</th>
      <th>Sum: Marginal of Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y=2</th>
      <td>0.03</td>
      <td>0.2025</td>
      <td>0.2325</td>
    </tr>
    <tr>
      <th>Y=1</th>
      <td>0.24</td>
      <td>0.0450</td>
      <td>0.2850</td>
    </tr>
    <tr>
      <th>Y=0</th>
      <td>0.48</td>
      <td>0.0025</td>
      <td>0.4825</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_dist_new</span><span class="o">.</span><span class="n">both_marginals</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X=0.2</th>
      <th>X=0.9</th>
      <th>Sum: Marginal of Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y=2</th>
      <td>0.03</td>
      <td>0.2025</td>
      <td>0.2325</td>
    </tr>
    <tr>
      <th>Y=1</th>
      <td>0.24</td>
      <td>0.0450</td>
      <td>0.2850</td>
    </tr>
    <tr>
      <th>Y=0</th>
      <td>0.48</td>
      <td>0.0025</td>
      <td>0.4825</td>
    </tr>
    <tr>
      <th>Sum: Marginal of X</th>
      <td>0.75</td>
      <td>0.2500</td>
      <td>1.0000</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_dist_new</span><span class="o">.</span><span class="n">conditional_dist_Y_given_X</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dist. of Y | X=0.2</th>
      <th>Dist. of Y | X=0.9</th>
      <th>Marginal of Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y=2</th>
      <td>0.04</td>
      <td>0.81</td>
      <td>0.2325</td>
    </tr>
    <tr>
      <th>Y=1</th>
      <td>0.32</td>
      <td>0.18</td>
      <td>0.2850</td>
    </tr>
    <tr>
      <th>Y=0</th>
      <td>0.64</td>
      <td>0.01</td>
      <td>0.4825</td>
    </tr>
    <tr>
      <th>Sum</th>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.0000</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_dist_new</span><span class="o">.</span><span class="n">conditional_dist_X_given_Y</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X=0.2</th>
      <th>X=0.9</th>
      <th>Sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Dist. of X | Y=2</th>
      <td>0.129032</td>
      <td>0.870968</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Dist. of X | Y=1</th>
      <td>0.842105</td>
      <td>0.157895</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Dist. of X | Y=0</th>
      <td>0.994819</td>
      <td>0.005181</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Marginal of X</th>
      <td>0.750000</td>
      <td>0.250000</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Independence">Independence<a class="anchor-link" href="#Independence">¶</a></h3></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 5 tosses of a fair coin</span>
<span class="c1"># X is the number of heads in the first 3 tosses </span>
<span class="n">three_coins</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># Y is the number of heads in the next two tosses</span>
<span class="n">two_coins</span> <span class="o">=</span> <span class="n">make_array</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
</pre></div></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">three_coins</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">*</span><span class="n">two_coins</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
<span class="n">tosses5</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">probability_function</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">tosses5</span>
<span class="n">joint_dist_2</span> <span class="o">=</span> <span class="n">tosses5</span><span class="o">.</span><span class="n">toJoint</span><span class="p">()</span>
<span class="n">joint_dist_2</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X=0</th>
      <th>X=1</th>
      <th>X=2</th>
      <th>X=3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y=2</th>
      <td>0.03125</td>
      <td>0.09375</td>
      <td>0.09375</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>Y=1</th>
      <td>0.06250</td>
      <td>0.18750</td>
      <td>0.18750</td>
      <td>0.06250</td>
    </tr>
    <tr>
      <th>Y=0</th>
      <td>0.03125</td>
      <td>0.09375</td>
      <td>0.09375</td>
      <td>0.03125</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_dist_2</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_dist_2</span><span class="o">.</span><span class="n">marginal_of_Y</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X=0</th>
      <th>X=1</th>
      <th>X=2</th>
      <th>X=3</th>
      <th>Sum: Marginal of Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y=2</th>
      <td>0.03125</td>
      <td>0.09375</td>
      <td>0.09375</td>
      <td>0.03125</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>Y=1</th>
      <td>0.06250</td>
      <td>0.18750</td>
      <td>0.18750</td>
      <td>0.06250</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>Y=0</th>
      <td>0.03125</td>
      <td>0.09375</td>
      <td>0.09375</td>
      <td>0.03125</td>
      <td>0.25</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_dist_2</span><span class="o">.</span><span class="n">marginal_of_X</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X=0</th>
      <th>X=1</th>
      <th>X=2</th>
      <th>X=3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y=2</th>
      <td>0.03125</td>
      <td>0.09375</td>
      <td>0.09375</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>Y=1</th>
      <td>0.06250</td>
      <td>0.18750</td>
      <td>0.18750</td>
      <td>0.06250</td>
    </tr>
    <tr>
      <th>Y=0</th>
      <td>0.03125</td>
      <td>0.09375</td>
      <td>0.09375</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>Sum: Marginal of X</th>
      <td>0.12500</td>
      <td>0.37500</td>
      <td>0.37500</td>
      <td>0.12500</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_dist_2</span><span class="o">.</span><span class="n">both_marginals</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X=0</th>
      <th>X=1</th>
      <th>X=2</th>
      <th>X=3</th>
      <th>Sum: Marginal of Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y=2</th>
      <td>0.03125</td>
      <td>0.09375</td>
      <td>0.09375</td>
      <td>0.03125</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>Y=1</th>
      <td>0.06250</td>
      <td>0.18750</td>
      <td>0.18750</td>
      <td>0.06250</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>Y=0</th>
      <td>0.03125</td>
      <td>0.09375</td>
      <td>0.09375</td>
      <td>0.03125</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>Sum: Marginal of X</th>
      <td>0.12500</td>
      <td>0.37500</td>
      <td>0.37500</td>
      <td>0.12500</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_dist_2</span><span class="o">.</span><span class="n">conditional_dist_X_given_Y</span><span class="p">()</span>
<span class="c1"># independence: all the rows are the same</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X=0</th>
      <th>X=1</th>
      <th>X=2</th>
      <th>X=3</th>
      <th>Sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Dist. of X | Y=2</th>
      <td>0.125</td>
      <td>0.375</td>
      <td>0.375</td>
      <td>0.125</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Dist. of X | Y=1</th>
      <td>0.125</td>
      <td>0.375</td>
      <td>0.375</td>
      <td>0.125</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Dist. of X | Y=0</th>
      <td>0.125</td>
      <td>0.375</td>
      <td>0.375</td>
      <td>0.125</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Marginal of X</th>
      <td>0.125</td>
      <td>0.375</td>
      <td>0.375</td>
      <td>0.125</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_dist_2</span><span class="o">.</span><span class="n">conditional_dist_Y_given_X</span><span class="p">()</span>
<span class="c1"># independence: all the columns are the same</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dist. of Y | X=0</th>
      <th>Dist. of Y | X=1</th>
      <th>Dist. of Y | X=2</th>
      <th>Dist. of Y | X=3</th>
      <th>Marginal of Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y=2</th>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>Y=1</th>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>Y=0</th>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>Sum</th>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table></div></div></div>