<div id="ipython-notebook">
            <a class="interact-button" href="http://prob140.berkeley.edu/user-redirect/interact?repo=prob140&path=textbook/Chapter 24/24_3_Linear_Combinations.ipynb">Interact</a>
            
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Linear-Combinations">Linear Combinations<a class="anchor-link" href="#Linear-Combinations">¶</a></h3><p>If $X$ and $Y$ are independent normal variables, then any linear combination $aX + bY + c$ has a normal distribution. We proved this in an earlier section using moment generating functions. We will now show that the same is true if $X$ and $Y$ have any bivariate normal distribution.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have defined standard bivariate normal random variables as follows:</p>
<p>If $X$ and $Z$ are i.i.d standard normal, and
$$
Y = \rho X + \sqrt{1 - \rho^2} Z
$$</p>
<p>then $X$ and $Y$ have the standard bivariate normal distribution with correlation $\rho$.</p>
<p>Thus if $X$ and $Y$ are standard bivariate normal, then $Y$ is a linear combination of the independent normal variables $X$ and $Z$. Hence any linear combination $aX + bY + c$ can be written as a different linear combination of the independent normal variables $X$ and $Z$. Thus the distribution of $aX + bY + c$ is normal.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If $X$ and $Y$ have a bivariate normal distribution but are not standardized, then $X = X*\sigma_X + \mu_X$ and $Y = Y^*\sigma_Y + \mu_Y$ where $X^*$ and $Y^*$ are standard bivariate normal.</p>
<p>So any linear combination of $X$ and $Y$ is a different linear combination of $X^*$ and $Y^*$, and hence is normal.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sum-and-Difference">Sum and Difference<a class="anchor-link" href="#Sum-and-Difference">¶</a></h3><p>Let $X$ and $Y$ have the bivariate normal distribution with parameters $(\mu_X, \mu_Y, \sigma_X^2, \sigma_Y^2, \rho)$. Then the sum $X + Y$ has the normal distribution with mean $\mu_X + \mu_Y$ and variance</p>
$$
\sigma_{X+Y}^2 ~ = ~ Var(X + Y) ~ = ~ \sigma_X^2 + \sigma_Y^2 + 2\rho\sigma_X\sigma_Y
$$<p>The difference $X - Y$ has the normal distribution with mean $\mu_X - \mu_Y$ and variance</p>
$$
\sigma_{X-Y}^2 ~ = ~ Var(X - Y) ~ = ~ \sigma_X^2 + \sigma_Y^2 - 2\rho\sigma_X\sigma_Y
$$<p>No matter what the linear combination of $X$ and $Y$, its distribution is normal and you can work out the mean and variance using properties of means and variances.</p>
<p>Notice that no matter what the joint distribution of $X$ and $Y$,</p>
$$
Cov(X+Y, X-Y) ~ = ~ Cov(X, X) - Cov(X, Y) + Cov(Y, X) - Cov(Y, Y)
~ = ~ \sigma_X^2 - \sigma_Y^2
$$<p>and the correlation between the sum and difference is
$$
r(X+Y, X-Y) ~ = ~ \frac{\sigma_X^2 - \sigma_Y^2}{\sigma_{X+Y}\sigma_{X-Y}}
$$</p>
<p>Each of the two linear combinations $X+Y$ and $X-Y$ is normal, and we have identified the two means, the two variances, and the correlation. It turns out (though we will not prove this) that the <em>joint</em> distribution of $X+Y$ and $X-Y$ is bivariate normal with the five parameters that we have identified.</p>
<p>In fact, a more general result is true:</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Joint-Distributions-of-Linear-Combinations">Joint Distributions of Linear Combinations<a class="anchor-link" href="#Joint-Distributions-of-Linear-Combinations">¶</a></h3><p>Let $X$ and $Y$ have a bivariate normal distribution. Then the linear combinations $aX + bY + c$ and $dX + eY + f$ have the bivariate normal distribution with parameters determined by rules of expectation and variance applied to the parameters of $X$ and $Y$.</p>
<p>In practical terms, this is saying that you can operate fearlessly with bivariate normal random variables just as you would with independent normal random variables. Just keep in mind that there will be some covariance terms involved in variance calculations.</p>
<p>For example, let $M$ be the midterm score and $F$ the final exam score of a student picked at random from a large class, and suppose $M$ and $F$ have the bivariate normal distribution with parameters $(66, 73, 10^2, 8^2, 0.6)$.</p>
<p>Suppose the overall score $S$ will be computed as $S = 0.3M + 0.7F$. What is the joint distribution of $F$ and $S$?</p>
<p>It's bivariate normal. All you have to do is find the five parameters. You already know two of them: $\mu_F = 73$ and $\sigma_F^2 = 8^2$.</p>
<p>Also, $\mu_S = 0.3*66 + 0.7*73 = 70.9$</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mf">0.3</span><span class="o">*</span><span class="mi">66</span> <span class="o">+</span> <span class="mf">0.7</span><span class="o">*</span><span class="mi">73</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>70.89999999999999</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To find $\sigma_S^2$ and $r(F, S)$, it's a good idea to find some covariances first.</p>
<ul>
<li>$Cov(M, F) = 0.6 \cdot 10 \cdot 8 = 48$</li>
<li>$Cov(F, S) = 0.3Cov(F, M) + 0.7Var(F) = 0.3 \cdot 48 + 0.7 \cdot 8^2 = 59.2$</li>
</ul></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mf">0.3</span><span class="o">*</span><span class="mi">48</span> <span class="o">+</span> <span class="mf">0.7</span><span class="o">*</span><span class="mi">64</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>59.199999999999996</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The variance of $S$ is
$$
\sigma_S^2 ~ = ~ 0.3^2 \cdot 10^2 ~ + ~ 0.7^2 \cdot 8^2 ~ + ~ 2 \cdot 0.3 \cdot 0.7 \cdot 48 ~ = ~ 60.52
$$</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.7</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="mf">0.7</span><span class="o">*</span><span class="mi">48</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>60.519999999999996</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final parameter of the bivariate normal is the correlation between $F$ and $S$.</p>
$$
r(F, S) ~ = ~ \frac{59.2}{8 \cdot \sqrt{60.52}} ~ = ~ 0.95
$$</div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mf">59.2</span><span class="o">/</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="mf">60.52</span><span class="o">**</span><span class="mf">0.5</span><span class="p">))</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>0.9512228189487625</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice how large the correlation is. That's because $F$ is a big component of $S$.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div></div></div></div>